# AI4S知识服务平台技术文档

## 项目背景

本项目为开源软件 DeePMD-kit 及相关软件领域开发了两套相互配合的系统：一个是基于FastGPT的RAG问答系统，另一个是自动化的论文处理流水线。

提供相关MCP Agnet工具, 部署在相关Bohrium等平台.

旨在为deepmd用户和开发者提供更高效、更精准的信息支持.

## 系统架构

### 整体设计

项目包含两个主要部分：

**AI4S Papers Service - 论文自动化处理工作流**
- Cloudflare R2存储和事件监听pdf文件上传
- Prefect工作流引擎 工作流调度,日志,监控
- Modal 按量使用量部署服务, 调用CPU/GPU服务进行PDF解析
- Google ADK Agent 提供agent,提取文章元数据
- Django API 关系型数据库ORM,存储到PostgreSQL, 提供API接口

**FastGPT RAG问答系统**
- 基于FastGPT框架构建的专业文献知识库和检索增强生成系统
- 工作流程包括三个核心步骤：
  1. 接收用户输入：通过多种渠道（网页、机器人、其他Agent）获取用户关于DeePMD的提问
  2. 智能检索：在专门构建的DeePMD知识库中，检索与问题最相关的文档、论文、代码或教程片段
  3. 生成回答：调用大语言模型（LLM），结合检索到的专业资料，生成精准且有依据的回答，输出到聊天框/微信、飞书机器人/其他agent
- 支持向量检索和语义匹配，确保检索准确性
- 提供多渠道接入支持，包括Web界面、IM机器人、MCP协议等

### 数据流程

```
PDF上传 → R2事件触发 → Prefect工作流调度 → Modal解析 → AI提取元数据 → 存储到数据库 → 同步到FastGPT知识库
```

用户通过Web界面、机器人或API查询时，系统从知识库检索相关内容，结合大模型生成专业回答。

## 核心功能模块

### RAG智能问答系统
- **功能**：根据用户提问，检索DeePMD专业知识库，由LLM生成回答
- **访问方式**：
  - 网页聊天：https://share.fastgpt.in/chat/share?shareId=dckb4tjmaygln3rst10pct6j
  - IM机器人：支持企业微信、飞书等平台
  - Agent调用：通过MCP协议调用
    ```
    MCP streamable-http https://api.fastgpt.in/api/mcp/app/wrSvRtDydWEb7faAP6uPooSX/mcp
    ```

### 知识库构建与维护
- **数据来源**：自动化脚本、网络爬虫、AI辅助处理、手动整理
- **内容类型**：
  - 学术文章：研究论文与预印本
  - 官方文档：DeePMD-kit文档和教程
  - 代码仓库：GitHub代码和示例
  - 社区内容：教程、笔记、公众号文章
- **处理流程**：原始资料经过清洗、切分、向量化，建立检索索引

### 自动化论文处理
- **文件管理**：文章连同相应markdown,文章元数据等,存到关系型数据库中,提供管理后台
- **PDF解析**：使用基于GPU的Marker引擎服务,将PDF转换为Markdown
- **元数据提取**：AI自动识别标题、作者、摘要、关键词等信息
- **API接口**：提供标准REST API供其他系统调用

---
Fig1. 知识库软件架构
[图片]

---

## 技术栈

### 后端技术
- **Django 4.x**：Web框架和API服务
- **PostgreSQL**：数据库存储
- **Prefect 3.x**：工作流编排
- **Modal**：GPU计算平台

### AI/ML组件
- **Google ADK**：AI Agent框架
- **Marker**：PDF解析引擎
- **FastGPT**：RAG问答框架

### 基础设施
- **Cloudflare R2**：对象存储
- **Cloudflare Workers**：事件处理
- **Docker**：容器化部署

---
Fig2. 聊天问答效果图。问题："讲讲deepmd的模型压缩功能,使用,代码"
回答引用了学术文章,在线文档,代码，给出功能介绍和具体指令
[图片]

---

## 解决的问题

### 信息检索难题
- DeePMD知识分散在论文、文档、代码库各处，手动查找费时费力
- 重复性问题频繁出现，缺乏统一的答案库

### 知识类型局限
- 仅靠学术文章无法解决实际开发问题
- 用户经常需要查找具体的代码片段、JSON配置、命令行示例

### 系统目标
通过一站式智能问答，提升信息获取效率，沉淀社区知识。

## 技术选型考虑

### 核心组件选择
- **FastGPT框架**：开源、知识库管理完善、支持线上服务和私有部署
  - 项目地址：https://github.com/labring/FastGPT
- **FastMCP协议**：与社区标准保持一致，支持Agent生态调用
  - 项目地址：https://github.com/jlowin/fastmcp
  - 相关集成已提交到AI4S-agent-tools仓库

### 主要挑战
- **数据整合**：处理多样化、格式各异的文档（PDF论文、代码、社区讨论等. 结合手动处理、自动化脚本和AI工具进行收集整理
- **技术栈/平台复杂**：用到涉及Cloudflare、Modal、Google ADK、Prefect、Django等多个云服务平台/技术栈/部署方式. (但都有用..)

## 下一步规划

基于初步的用户反馈和系统运行效果，我们计划在以下几个方向继续改进：

### 知识库扩展
- 加入更多数据, 进一步优化数据收集工具，扩大知识库,文档覆盖范围,更自动化

### 系统优化
- 引入机制，自动评估与优化问答质量。进而优化流程/提示词/模型/数据集

### 推广应用
- 在DeePMD用户群体中进行更广泛的推广，提升社区技术支持效率
- 与其他社区内其他开发者/工作流开发者/科学计算开源项目的开发团队分享实践经验/技术架构，协助构建类似的知识服务系统/其他类型处理工作流

---
